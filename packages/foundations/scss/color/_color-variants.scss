@use "sass:string";
@use "../color-placeholder" as *;
@use "../variables" as *;
@use "../variables.global" as var;

$color-variants: "neutral", "neutral-strong", "primary", "critical",
	"successful", "warning", "informational";

@mixin color-variants($ia) {
	@each $variant in $color-variants {
		&[data-color-variant="#{$variant}"] {
			@extend %db-bg-#{$variant};
		}
		@if ($ia == true) {
			&[data-color-variant="#{$variant}-ia"] {
				@extend %db-bg-#{$variant}-ia;
			}
		}
	}
}

%color-variants {
	@include color-variants(false);
}
%color-variants-ia {
	@include color-variants(true);
}

@mixin get-variant-bg-color($alpha) {
	background-color: color-mix(
		in srgb,
		transparent
			var(
				--db-current-base-color-alpha,
				string.unquote(calc((1 - $alpha) * 100) + "%")
			),
		var(--db-current-base-color, #fff)
	);
}

%bg-transparent {
	@include get-variant-bg-color(0);
}

@mixin bg-transparent-hover($with-enabled: true) {
	@extend %bg-transparent;

	@if ($with-enabled) {
		&:enabled {
			&:hover {
				@include get-variant-bg-color(0.16);
			}
		}
	} @else {
		&:hover {
			@include get-variant-bg-color(0.16);
		}
	}
}

@mixin bg-transparent-interactive($with-enabled: true) {
	@include bg-transparent-hover($with-enabled);

	@if ($with-enabled) {
		&:enabled {
			&:active {
				@include get-variant-bg-color(0.24);
			}
		}
	} @else {
		&:active {
			@include get-variant-bg-color(0.24);
		}
	}
}

%db-bg-inverted {
	color: var(--db-current-bg-color);
	background-color: var(--db-current-color);
}

%db-bg-inverted-ia {
	@extend %db-bg-inverted;

	&::before {
		color: var(--db-current-bg-color);
	}

	&:enabled {
		&:hover {
			background-color: color-mix(
				in srgb,
				transparent 16%,
				var(--db-current-color)
			);
		}

		&:active {
			background-color: color-mix(
				in srgb,
				transparent 24%,
				var(--db-current-color)
			);
		}
	}
}

$component-variants: (
	"critical": (
		"border": var.$db-colors-critical-border-weak,
		"element": var.$db-colors-critical-element,
		"on-bg": var.$db-colors-critical-on-bg,
		"primary": var.$db-colors-critical
	),
	"informational": (
		"border": var.$db-colors-informational-border-weak,
		"element": var.$db-colors-informational-element,
		"on-bg": var.$db-colors-informational-on-bg,
		"primary": var.$db-colors-informational
	),
	"warning": (
		"border": var.$db-colors-warning-border-weak,
		"element": var.$db-colors-warning-element,
		"on-bg": var.$db-colors-warning-on-bg,
		"primary": var.$db-colors-warning
	),
	"successful": (
		"border": var.$db-colors-successful-border-weak,
		"element": var.$db-colors-successful-element,
		"on-bg": var.$db-colors-successful-on-bg,
		"primary": var.$db-colors-successful
	)
);
